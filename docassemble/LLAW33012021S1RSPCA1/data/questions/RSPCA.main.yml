# This is the main file for the RSPCA Information Form Automation App
---
metadata:
  title: |
    RSPCA Court Summons Prototype
  short title: |
    Summons Automation
  organisation: Flinders University
  show login: True
---
default screen parts:
  post: |
    <div style="display: flex; height: 200px; align-items: flex-end; flex-direction: row-reverse">
    <div style="margin: 5px"><img src="https://staff.flinders.edu.au/etc.clientlibs/flinders/clientlibs/clientlib-site/resources/images/flinderuni_main_logo_black.png" height="40">
    </div>
    <div style="margin: 5px; text-align: right">
    <cite><small><i>
    Developed by Flinders University in collaboration with RSPCA SA
    </i></small></cite>
    </div>
    </div>
---
include:
  - RSPCA.questions.yml
  - RSPCA.offence_location.yml
  - RSPCA_sittingLocation.yml
  - RSPCA.countList.yml
  # A1_RSPCA_court_list.yml
  # A1_RSPCA_get_qualified_court.yml
  # A1_RSPCA_display_output.yml
---
objects:
  # RSPCAqualifying_court: DAList.using(there_are_any=True, auto_gather=False)
  - count: DAList.using(object_type=Thing, minimum_number=1)
  - RSPCA_logo: DAStaticFile.using(filename='rspca-sa-logo.png')
  - endpoints: DADict
---
features:
  css: X2.01.SACAT.css
  debug: True
  hide standard menu: False
---
mandatory: True
code: |
  # To use a custom logo we need to set the 'logo' metadata to 
  # some custom HTML.  The string below creates the HTML and 
  # inserts into it the logo contained in the file RSPCA_logo using
  # the python format() method 
  RSPCA_logostring = '<div class="media"><img src="{}" class="mr-3" height="50"><div class="media-body"></div></div>'.format(RSPCA_logo.url_for())

  # Once we've created the string we use set_parts() to set our new logo metadata
  set_parts(logo=RSPCA_logostring)
---
# This code drives the app
#driver code (create the endpoints to test elgibility
mandatory: True
code: |
  ###Can only be two options so only need two endpoints
  if RSPCAeligible:
    #set the endpoint to the final screen we want to display
    endpoints['final_screen']
  else:
     #not eligbile so show ineligible screen
    endpoints['ineligible']
---
event: endpoints['final_screen']
question: ""
subquestion: |
  ### This is the final endpoint screen
  
  This screen will display the information that had been entered
  
  This screen will also display options to save the document as docx/pdf 
  
  
  **Summary of Count information:**
  
  % for index in range(count.current_index()+1):
  
  % if count.item(index).dateTo == "":
  % if count.item(index).name.text == 'Abandonment':
  **Count ${ (index+1) } **
  
  On ${count[index].dateFrom} at ${count.item(index).offenceLocation}, in the State of South Australia, the defendant ill-treated an animal, namely ${count.item(index).offenceAnimal}.
  
  *Section ${count[index].countSection} of the Animal Welfare Act 1985.*
  
  ** Particulars **
  
  ${ count[index].particularDetails }
  
  *Section ${count[index].countSection} of the Animal Welfare Act 1985.*
  % endif
  
  % if count.item(index).name.text == 'Fail to provide adequate food':
  **Count ${ (index+1) } **
  
  On ${count[index].dateFrom} at ${count.item(index).offenceLocation}, in the State of South Australia, the defendant ill-treated an animal, with the ill-treatment causing serious harm to the animal, namely ${count.item(index).offenceAnimal}.
  
  *Section ${count[index].countSection} of the Animal Welfare Act 1985.*
  
  ** Particulars **
  
  ${ count[index].particularDetails }
  
  *Section ${count[index].countSection} of the Animal Welfare Act 1985.*
  % endif
  
  % if count.item(index).name.text == 'Neglect':
  **Count ${ (index+1) } **
  
  On ${count[index].dateFrom} at ${count.item(index).offenceLocation}, in the State of South Australia, the defendant ill-treated an animal, namely ${count.item(index).offenceAnimal}.
  
  *Section ${count[index].countSection} of the Animal Welfare Act 1985.*
  
  ** Particulars **
  
  ${ count[index].particularDetails }
  
  *Section ${count[index].countSection} of the Animal Welfare Act 1985.*
  % endif
  
  % if count.item(index).name.text == 'Breach of order':
  **Count ${ (index+1) } **
  
  On ${count[index].dateFrom} at ${count.item(index).offenceLocation}, in the State of South Australia, the defendant,, being a person in relation to whom an order under section 32A(1) of the Animal Welfare Act 1985 was in force, failed to comply with that order, contrary to Section 32A(2) of the Animal Welfare Act 1985.
  
  ** Particulars **
  
  ${ count[index].particularDetails }
  % endif
  
  % else:
  % if count.item(index).name.text == 'Abandonment':
  **Count ${ (index+1) } **
  
  Between ${count[index].dateFrom} and ${count.item(index).dateTo} at ${count.item(index).offenceLocation}, in the State of South Australia, the defendant ill-treated an animal, namely ${count.item(index).offenceAnimal}.
  
  *Section ${count[index].countSection} of the Animal Welfare Act 1985.*
  
  ** Particulars **
  
  ${ count[index].particularDetails }
  
  *Section ${count[index].countSection} of the Animal Welfare Act 1985.*
  % endif
  
  % if count.item(index).name.text == 'Fail to provide adequate food':
  **Count ${ (index+1) } **
  
  Between ${count[index].dateFrom} and ${count.item(index).dateTo} at ${count.item(index).offenceLocation}, in the State of South Australia, the defendant ill-treated an animal, with the ill-treatment causing serious harm to the animal, namely ${count.item(index).offenceAnimal}.
  
  *Section ${count[index].countSection} of the Animal Welfare Act 1985.*
  
  ** Particulars **
  
  ${ count[index].particularDetails }
  
  *Section ${count[index].countSection} of the Animal Welfare Act 1985.*
  % endif
  
  % if count.item(index).name.text == 'Neglect':
  **Count ${ (index+1) } **
  
  Between ${count[index].dateFrom} and ${count.item(index).dateTo} at ${count.item(index).offenceLocation}, in the State of South Australia, the defendant ill-treated an animal, namely ${count.item(index).offenceAnimal}.
  
  *Section ${count[index].countSection} of the Animal Welfare Act 1985.*
  
  ** Particulars **
  
  ${ count[index].particularDetails }
  
  *Section ${count[index].countSection} of the Animal Welfare Act 1985.*
  % endif
  
  % if count.item(index).name.text == 'Breach of order':
  **Count ${ (index+1) } **
  
  Between ${count[index].dateFrom} and ${count.item(index).dateTo} at ${count.item(index).offenceLocation}, in the State of South Australia, the defendant,, being a person in relation to whom an order under section 32A(1) of the Animal Welfare Act 1985 was in force, failed to comply with that order, contrary to Section 32A(2) of the Animal Welfare Act 1985.
  
  ** Particulars **
  
  ${ count[index].particularDetails }
  
  % endif
  % endif
  % endfor
  
  **Summary of hearing details:**

  
  Need to add time/date still
  Need to add summary of offence details
  
  **Attachment details (pdf/docx)**
  Here is your document!

  %if offence_selection == 'sum_off' or offence_selection == 'minor_off':
  %if animal_surrendered:
    ${ RSPCA_form2 }
    ${ RSPCA_form23 }
    ${ RSPCA_form8 }
  %elif req_orders == 'Yes':
    ${ RSPCA_form2 }
    ${ RSPCA_form23 }
    ${ RSPCA_form8 }
  %else:
    ${ RSPCA_form2 }
    ${ RSPCA_form8 }
  %endif
  %elif offence_selection == 'sum_off2' or offence_selection == 'minor_off2':
  %if animal_surrendered:
    ${ RSPCA_form3 }
    ${ RSPCA_form23 }
  %elif req_orders == 'Yes':
    ${ RSPCA_form3 }
    ${ RSPCA_form23 }
  %else:
    ${ RSPCA_form3 }
  %endif
  %elif req_orders == 'Yes':
  ${ RSPCA_form2 }
  ${ RSPCA_form8 }
  ${ RSPCA_form23 }
  %else:
  ${ RSPCA_form2 }
  ${ RSPCA_form8 }
  %endif
  
buttons:
  - Exit: exit
    url: https://www.rspca.org.au/
  - Restart: restart
---
attachment: 
  - name: RSPCA Form 2
    filename: RSPCA Form 2 Printout
    valid formats:
      - pdf
    docx template file: RSPCA_form2_Copy.docx
    variable name: RSPCA_form2
---
attachment: 
  - name: RSPCA Form 3
    filename: RSPCA Form 3 Printout
    valid formats:
      - pdf
    docx template file: RSPCA_form3_Copy.docx
    variable name: RSPCA_form3
---
attachment: 
  - name: RSPCA Form 23
    filename: RSPCA Form 23 Printout
    valid formats:
      - pdf
    docx template file: RSPCA_form23_Copy.docx
    variable name: RSPCA_form23
---
attachment: 
  - name: RSPCA Form 8
    filename: RSPCA Form 8 Printout
    valid formats:
      - pdf
    docx template file: RSPCA_form8_Copy.docx
    variable name: RSPCA_form8
---
event: endpoints['ineligible']
question: Not Eligible
subquestion:
  The disclaimer has not been understood and accepted.  Please exit the
  application or restart if you'd like to accept the disclaimer.
buttons:
  - Exit: exit
    url: https://www.rspca.org.au/
  - Restart: restart
---
