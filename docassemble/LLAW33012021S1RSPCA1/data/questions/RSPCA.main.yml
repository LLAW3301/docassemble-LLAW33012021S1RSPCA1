# Main file for the RSPCA document automation App
---
metadata: 
  title: |
    RSPCA Court Summons Prototype
  short title: |
      Summons Automation
  organisation: Flinders University
  show login: True
---
default screen parts:
  post: |
    <div style="display: flex; height: 200px; align-items: flex-end; flex-direction: row-reverse">
    <div style="margin: 5px"><img src="https://staff.flinders.edu.au/etc.clientlibs/flinders/clientlibs/clientlib-site/resources/images/flinderuni_main_logo_black.png" height="40">
    </div>
    <div style="margin: 5px; text-align: right">
    <cite><small><i>
    Developed by Flinders University in collaboration with RSPCA
    </i></small></cite>
    </div>
    </div>
---
#add files that we need to include (questions, registry lists etc.)
include:
  - RSPCA.questions.yml
  - RSPCA.registries.yml
  - RSPCA_get_qualified_court.yml
  - RSPCA_display_output.yml
---
#objects that we need e.g endpoints and logos (can add this later)
objects:
  #- placeholder.registries
  - RSPCAqualifying_court: DAList.using(there_are_any=True, auto_gather=False)
  #- placeholder.RSPCA_logo
  - RSPCA_logo: DAStaticFile.using(filename='rspca-sa-logo.png')
  - endpoints: DADict
---
#css file (can add this later)
features:
  css: X2.01.SACAT.css
  debug: True
  hide standard menu: False
---
##come back to this later and add in a logo to be displayed on all pages
mandatory: True
code: |
  RSPCA_logostring = '<div class="media"><img src="{}" class="mr-3" height="50"><div class="media-body"></div></div>'.format(RSPCA_logo.url_for())
  set_parts(logo=RSPCA_logostring)
---
#driver code (create the endpoints to test elgibility
mandatory: True
code: |
  ###Can only be two options so only need two endpoints
  if RSPCAeligible:
    #set the endpoint to the final screen we want to display
    endpoints['final_screen']
  else:
     #not eligbile so show ineligible screen
    endpoints['ineligible']
---
event: endpoints['final_screen']
question: ""
subquestion: |
  ### This is the final endpoint screen
  
  This screen will display the information that had been entered
  
  This screen will also display options to save the document as docx/pdf 
  
  This is for form type: ${ RSPCAform }
  
  **Summary of defendant information:**  
  
  **Summary of hearing details:**
  
  ** Courtlist based on postcode
  %for RSPCAdisplay_entry in RSPCAdisplay_court:
  ${ RSPCAdisplay_entry['display_record'].show() }
  %endfor
  
  
  Need to add time/date still

  Need to add summary of offence details
  
  **Attachment details (pdf/docx)**
  Here is your document!

  %if ( offence_selection == 'sum_off_form2' ) or ( offence_selection == 'major_off' ):
  %if req_orders:
    ${ RSPCA_form2 }
    ${ RSPCA_form23 }
  %endif
  %elif offence_selection == 'sum_off_form3':
  %if req_orders:
    ${ RSPCA_form3 }
    ${ RSPCA_form23 }
  %endif
  %else:
  ${ RSPCA_form2 }
  ${ RSPCA_form8 }
  %endif
  
buttons:
  - Exit: exit
    url: https://www.rspca.org.au/
  - Restart: restart
---
attachment: 
  - name: RSPCA Form 2
    filename: RSPCA Form 2 Printout
    valid formats:
      - pdf
    docx template file: RSPCA_form2.docx
    variable name: RSPCA_form2
---
attachment: 
  - name: RSPCA Form 3
    filename: RSPCA Form 3 Printout
    valid formats:
      - pdf
    docx template file: RSPCA_form3.docx
    variable name: RSPCA_form3
---
attachment: 
  - name: RSPCA Form 23
    filename: RSPCA Form 23 Printout
    valid formats:
      - pdf
    docx template file: RSPCA_form23.docx
    variable name: RSPCA_form23
---
attachment: 
  - name: RSPCA Form 8
    filename: RSPCA Form 8 Printout
    valid formats:
      - pdf
    docx template file: RSPCA_form8.docx
    variable name: RSPCA_form8
---
event: endpoints['ineligible']
question: Not Eligible
subquestion:
  This disclaimer has not been accpeted or other possible issues tbc 
buttons:
  - Exit: exit
    url: https://www.rspca.org.au/
  - Restart: restart
---
